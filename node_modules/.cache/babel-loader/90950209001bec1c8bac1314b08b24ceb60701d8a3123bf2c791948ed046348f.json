{"ast":null,"code":"import { addDoc, collection, getDocs, orderBy, query, serverTimestamp, arrayUnion, doc, getDoc, updateDoc } from \"firebase/firestore\";\nimport { firestore } from \"../firebase_setup/firebase\";\nconst movieCollection = collection(firestore, \"movies\");\nconst seriesCollection = collection(firestore, \"series\");\nconst {\n  currentUser\n} = useAuthContext();\nexport const addNewShow = async (type, showData) => {\n  let collectionType = type === 'Movie' ? movieCollection : seriesCollection;\n  try {\n    await addDoc(collectionType, {\n      ...showData,\n      rating: '',\n      createdAt: serverTimestamp()\n    });\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\nexport const getAll = async type => {\n  let collectionType = type === 'Movie' ? movieCollection : seriesCollection;\n  const orderedQuery = query(collectionType, orderBy('createdAt', 'desc'));\n  try {\n    const result = await getDocs(orderedQuery).then(docs => {\n      let arr = [];\n      docs.forEach(doc => {\n        let fields = doc.data();\n        arr.push({\n          id: doc.id,\n          fields: fields\n        });\n      });\n      return arr;\n    });\n    // console.log(result);\n    return result;\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\nexport const addToWishList = async (type, userId, showId) => {\n  const currentUserRef = doc(firestore, 'users', userId);\n  await updateDoc(currentUserRef, {\n    watchlist: arrayUnion({\n      showId,\n      type\n    })\n  });\n};\nexport const getAllFromWatchlist = async () => {\n  const currentUserRef = collection(firestore, 'users');\n  try {\n    const result = await getDoc(doc(currentUserRef, userId));\n    // .then(doc => doc.data().watchlist);\n    const watchlist = result.data().watchlist;\n    console.log(watchlist);\n    return watchlist;\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};","map":{"version":3,"names":["addDoc","collection","getDocs","orderBy","query","serverTimestamp","arrayUnion","doc","getDoc","updateDoc","firestore","movieCollection","seriesCollection","currentUser","useAuthContext","addNewShow","type","showData","collectionType","rating","createdAt","err","console","error","alert","message","getAll","orderedQuery","result","then","docs","arr","forEach","fields","data","push","id","addToWishList","userId","showId","currentUserRef","watchlist","getAllFromWatchlist","log"],"sources":["C:/Users/User/Desktop/Final PRoject -LMDb/lmdb/src/services/showsService.js"],"sourcesContent":["import { addDoc, collection, getDocs, orderBy, query, serverTimestamp, arrayUnion, doc, getDoc, updateDoc } from \"firebase/firestore\";\r\nimport { firestore } from \"../firebase_setup/firebase\";\r\n\r\n\r\nconst movieCollection = collection(firestore, \"movies\");\r\nconst seriesCollection = collection(firestore, \"series\");\r\nconst { currentUser } = useAuthContext();\r\n\r\n\r\nexport const addNewShow = async (type, showData) => {\r\n    let collectionType = type === 'Movie' ? movieCollection : seriesCollection;\r\n    try {\r\n        await addDoc(collectionType, {\r\n            ...showData,\r\n            rating: '',\r\n            createdAt: serverTimestamp()\r\n        });\r\n    } catch (err) {\r\n        console.error(err);\r\n        alert(err.message);\r\n    }\r\n};\r\n\r\nexport const getAll = async (type) => {\r\n    let collectionType = type === 'Movie' ? movieCollection : seriesCollection;\r\n\r\n    const orderedQuery = query(collectionType, orderBy('createdAt', 'desc'));\r\n    try {\r\n        const result = await getDocs(orderedQuery)\r\n            .then(docs => {\r\n                let arr = [];\r\n\r\n                docs.forEach((doc) => {\r\n                    let fields = doc.data();\r\n\r\n                    arr.push({\r\n                        id: doc.id,\r\n                        fields: fields\r\n                    });\r\n                });\r\n                return arr;\r\n            });\r\n        // console.log(result);\r\n        return result;\r\n\r\n    } catch (err) {\r\n        console.error(err);\r\n        alert(err.message);\r\n    }\r\n};\r\n\r\n\r\nexport const addToWishList = async (type, userId, showId) => {\r\n    const currentUserRef = doc(firestore, 'users', userId);\r\n\r\n    await updateDoc(currentUserRef, {\r\n        watchlist: arrayUnion({ showId, type })\r\n    });\r\n};\r\n\r\nexport const getAllFromWatchlist = async () => {\r\n    const currentUserRef = collection(firestore, 'users');\r\n    try {\r\n        const result = await getDoc(doc(currentUserRef, userId))\r\n        // .then(doc => doc.data().watchlist);\r\n        const watchlist = result.data().watchlist;\r\n        console.log(watchlist);\r\n        return watchlist;\r\n    } catch (err) {\r\n        console.error(err);\r\n        alert(err.message);\r\n    }\r\n\r\n};\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}